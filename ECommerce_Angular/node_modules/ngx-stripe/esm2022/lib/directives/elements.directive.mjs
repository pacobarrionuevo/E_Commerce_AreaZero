import { Directive, Input, Output, EventEmitter } from '@angular/core';
import { from } from 'rxjs';
import * as i0 from "@angular/core";
import * as i1 from "../services/stripe-elements.service";
export class StripeElementsDirective {
    stripeElementsService;
    elementsOptions;
    stripe;
    elements = new EventEmitter();
    _elements;
    state = 'notready';
    constructor(stripeElementsService) {
        this.stripeElementsService = stripeElementsService;
    }
    async ngOnChanges(changes) {
        this.state = 'starting';
        const elementsOptions = this.elementsOptions;
        const stripe = this.stripe;
        if (!stripe) {
            this.state = 'notready';
            return;
        }
        if (changes.elementsOptions) {
            if (this._elements) {
                const payload = Object.keys(elementsOptions).reduce((acc, key) => {
                    if (elementsOptions[key] !== changes.elementsOptions.previousValue[key] &&
                        !['fonts', 'loader', 'clientSecret'].includes(key)) {
                        acc[key] = elementsOptions[key];
                    }
                    return acc;
                }, {});
                this._elements.update(payload);
            }
            else {
                this._elements = await this.stripeElementsService.elements(stripe, elementsOptions).toPromise();
                this.elements.emit(this._elements);
                this.state = 'ready';
            }
        }
    }
    async ngOnInit() {
        if (this.state === 'notready') {
            this.state = 'starting';
            this._elements = await this.stripeElementsService.elements(this.stripe).toPromise();
            this.elements.emit(this._elements);
            this.state = 'ready';
        }
    }
    fetchUpdates() {
        if (!this._elements)
            return null;
        return from(this._elements.fetchUpdates());
    }
    update(options) {
        if (!this._elements)
            return null;
        return this._elements.update(options);
    }
    submit() {
        if (!this._elements)
            return null;
        return from(this._elements.submit());
    }
    getElement(elementType) {
        if (!this._elements)
            return null;
        switch (elementType) {
            case 'address':
                return this._elements.getElement('address');
            case 'paymentMethodMessaging':
                return this._elements.getElement('paymentMethodMessaging');
            case 'affirmMessage':
                return this._elements.getElement('affirmMessage');
            case 'afterpayClearpayMessage':
                return this._elements.getElement('afterpayClearpayMessage');
            case 'auBankAccount':
                return this._elements.getElement('auBankAccount');
            case 'card':
                return this._elements.getElement('card');
            case 'cardNumber':
                return this._elements.getElement('cardNumber');
            case 'cardExpiry':
                return this._elements.getElement('cardExpiry');
            case 'cardCvc':
                return this._elements.getElement('cardCvc');
            case 'fpxBank':
                return this._elements.getElement('fpxBank');
            case 'epsBank':
                return this._elements.getElement('epsBank');
            case 'p24Bank':
                return this._elements.getElement('p24Bank');
            case 'iban':
                return this._elements.getElement('iban');
            case 'idealBank':
                return this._elements.getElement('idealBank');
            case 'linkAuthentication':
                return this._elements.getElement('linkAuthentication');
            case 'expressCheckout':
                return this._elements.getElement('expressCheckout');
            case 'payment':
                return this._elements.getElement('payment');
            case 'paymentRequestButton':
                return this._elements.getElement('paymentRequestButton');
            case 'shippingAddress':
                return this._elements.getElement('shippingAddress');
            default:
                return this._elements.getElement(elementType);
        }
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.0.0", ngImport: i0, type: StripeElementsDirective, deps: [{ token: i1.StripeElementsService }], target: i0.ɵɵFactoryTarget.Directive });
    static ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "18.0.0", type: StripeElementsDirective, isStandalone: true, selector: "ngx-stripe-elements,[ngxStripeElements]", inputs: { elementsOptions: "elementsOptions", stripe: "stripe" }, outputs: { elements: "elements" }, usesOnChanges: true, ngImport: i0 });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.0.0", ngImport: i0, type: StripeElementsDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: 'ngx-stripe-elements,[ngxStripeElements]',
                    standalone: true
                }]
        }], ctorParameters: () => [{ type: i1.StripeElementsService }], propDecorators: { elementsOptions: [{
                type: Input
            }], stripe: [{
                type: Input
            }], elements: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWxlbWVudHMuZGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LXN0cmlwZS9zcmMvbGliL2RpcmVjdGl2ZXMvZWxlbWVudHMuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFvQyxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3pHLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxNQUFNLENBQUM7OztBQW1DNUIsTUFBTSxPQUFPLHVCQUF1QjtJQVNmO0lBUlYsZUFBZSxDQUFpQztJQUNoRCxNQUFNLENBQXlCO0lBRTlCLFFBQVEsR0FBRyxJQUFJLFlBQVksRUFBa0IsQ0FBQztJQUV4RCxTQUFTLENBQWlCO0lBQzFCLEtBQUssR0FBc0MsVUFBVSxDQUFDO0lBRXRELFlBQW1CLHFCQUE0QztRQUE1QywwQkFBcUIsR0FBckIscUJBQXFCLENBQXVCO0lBQUcsQ0FBQztJQUVuRSxLQUFLLENBQUMsV0FBVyxDQUFDLE9BQXNCO1FBQ3RDLElBQUksQ0FBQyxLQUFLLEdBQUcsVUFBVSxDQUFDO1FBRXhCLE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUM7UUFDN0MsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUUzQixJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDWixJQUFJLENBQUMsS0FBSyxHQUFHLFVBQVUsQ0FBQztZQUN4QixPQUFPO1FBQ1QsQ0FBQztRQUVELElBQUksT0FBTyxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQzVCLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO2dCQUNuQixNQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRTtvQkFD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LFVBQVUsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO1lBQzNELEtBQUssaUJBQWlCO2dCQUNwQixPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLENBQUM7WUFDdEQ7Z0JBQ0UsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUNsRCxDQUFDO0lBQ0gsQ0FBQzt1R0F0SVUsdUJBQXVCOzJGQUF2Qix1QkFBdUI7OzJGQUF2Qix1QkFBdUI7a0JBSm5DLFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLHlDQUF5QztvQkFDbkQsVUFBVSxFQUFFLElBQUk7aUJBQ2pCOzBGQUVVLGVBQWU7c0JBQXZCLEtBQUs7Z0JBQ0csTUFBTTtzQkFBZCxLQUFLO2dCQUVJLFFBQVE7c0JBQWpCLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaXJlY3RpdmUsIElucHV0LCBPbkluaXQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcywgT3V0cHV0LCBFdmVudEVtaXR0ZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IGZyb20gfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHtcbiAgU3RyaXBlQWRkcmVzc0VsZW1lbnQsXG4gIFN0cmlwZUFmZmlybU1lc3NhZ2VFbGVtZW50LFxuICBTdHJpcGVBZnRlcnBheUNsZWFycGF5TWVzc2FnZUVsZW1lbnQsXG4gIFN0cmlwZUF1QmFua0FjY291bnRFbGVtZW50LFxuICBTdHJpcGVDYXJkQ3ZjRWxlbWVudCxcbiAgU3RyaXBlQ2FyZEVsZW1lbnQsXG4gIFN0cmlwZUNhcmRFeHBpcnlFbGVtZW50LFxuICBTdHJpcGVDYXJkTnVtYmVyRWxlbWVudCxcbiAgU3RyaXBlRWxlbWVudHMsXG4gIFN0cmlwZUVsZW1lbnRzT3B0aW9ucyxcbiAgU3RyaXBlRWxlbWVudHNVcGRhdGVPcHRpb25zLFxuICBTdHJpcGVFcHNCYW5rRWxlbWVudCxcbiAgU3RyaXBlRXhwcmVzc0NoZWNrb3V0RWxlbWVudCxcbiAgU3RyaXBlRnB4QmFua0VsZW1lbnQsXG4gIFN0cmlwZUliYW5FbGVtZW50LFxuICBTdHJpcGVJZGVhbEJhbmtFbGVtZW50LFxuICBTdHJpcGVMaW5rQXV0aGVudGljYXRpb25FbGVtZW50LFxuICBTdHJpcGVQMjRCYW5rRWxlbWVudCxcbiAgU3RyaXBlUGF5bWVudEVsZW1lbnQsXG4gIFN0cmlwZVBheW1lbnRNZXRob2RNZXNzYWdpbmdFbGVtZW50LFxuICBTdHJpcGVQYXltZW50UmVxdWVzdEJ1dHRvbkVsZW1lbnQsXG4gIFN0cmlwZVNoaXBwaW5nQWRkcmVzc0VsZW1lbnRcbn0gZnJvbSAnQHN0cmlwZS9zdHJpcGUtanMnO1xuXG5pbXBvcnQgeyBTdHJpcGVTZXJ2aWNlSW50ZXJmYWNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9zdHJpcGUtaW5zdGFuY2UuaW50ZXJmYWNlJztcblxuaW1wb3J0IHsgU3RyaXBlRWxlbWVudHNTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvc3RyaXBlLWVsZW1lbnRzLnNlcnZpY2UnO1xuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICduZ3gtc3RyaXBlLWVsZW1lbnRzLFtuZ3hTdHJpcGVFbGVtZW50c10nLFxuICBzdGFuZGFsb25lOiB0cnVlXG59KVxuZXhwb3J0IGNsYXNzIFN0cmlwZUVsZW1lbnRzRGlyZWN0aXZlIGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xuICBASW5wdXQoKSBlbGVtZW50c09wdGlvbnM6IFBhcnRpYWw8U3RyaXBlRWxlbWVudHNPcHRpb25zPjtcbiAgQElucHV0KCkgc3RyaXBlOiBTdHJpcGVTZXJ2aWNlSW50ZXJmYWNlO1xuXG4gIEBPdXRwdXQoKSBlbGVtZW50cyA9IG5ldyBFdmVudEVtaXR0ZXI8U3RyaXBlRWxlbWVudHM+KCk7XG5cbiAgX2VsZW1lbnRzOiBTdHJpcGVFbGVtZW50cztcbiAgc3RhdGU6ICdub3RyZWFkeScgfCAnc3RhcnRpbmcnIHwgJ3JlYWR5JyA9ICdub3RyZWFkeSc7XG5cbiAgY29uc3RydWN0b3IocHVibGljIHN0cmlwZUVsZW1lbnRzU2VydmljZTogU3RyaXBlRWxlbWVudHNTZXJ2aWNlKSB7fVxuXG4gIGFzeW5jIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcbiAgICB0aGlzLnN0YXRlID0gJ3N0YXJ0aW5nJztcblxuICAgIGNvbnN0IGVsZW1lbnRzT3B0aW9ucyA9IHRoaXMuZWxlbWVudHNPcHRpb25zO1xuICAgIGNvbnN0IHN0cmlwZSA9IHRoaXMuc3RyaXBlO1xuXG4gICAgaWYgKCFzdHJpcGUpIHtcbiAgICAgIHRoaXMuc3RhdGUgPSAnbm90cmVhZHknO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChjaGFuZ2VzLmVsZW1lbnRzT3B0aW9ucykge1xuICAgICAgaWYgKHRoaXMuX2VsZW1lbnRzKSB7XG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSBPYmplY3Qua2V5cyhlbGVtZW50c09wdGlvbnMpLnJlZHVjZSgoYWNjLCBrZXkpID0+IHtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICBlbGVtZW50c09wdGlvbnNba2V5XSAhPT0gY2hhbmdlcy5lbGVtZW50c09wdGlvbnMucHJldmlvdXNWYWx1ZVtrZXldICYmXG4gICAgICAgICAgICAhWydmb250cycsICdsb2FkZXInLCAnY2xpZW50U2VjcmV0J10uaW5jbHVkZXMoa2V5KVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgYWNjW2tleV0gPSBlbGVtZW50c09wdGlvbnNba2V5XTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfSwge30pO1xuXG4gICAgICAgIHRoaXMuX2VsZW1lbnRzLnVwZGF0ZShwYXlsb2FkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2VsZW1lbnRzID0gYXdhaXQgdGhpcy5zdHJpcGVFbGVtZW50c1NlcnZpY2UuZWxlbWVudHMoc3RyaXBlLCBlbGVtZW50c09wdGlvbnMpLnRvUHJvbWlzZSgpO1xuICAgICAgICB0aGlzLmVsZW1lbnRzLmVtaXQodGhpcy5fZWxlbWVudHMpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSAncmVhZHknO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIG5nT25Jbml0KCkge1xuICAgIGlmICh0aGlzLnN0YXRlID09PSAnbm90cmVhZHknKSB7XG4gICAgICB0aGlzLnN0YXRlID0gJ3N0YXJ0aW5nJztcblxuICAgICAgdGhpcy5fZWxlbWVudHMgPSBhd2FpdCB0aGlzLnN0cmlwZUVsZW1lbnRzU2VydmljZS5lbGVtZW50cyh0aGlzLnN0cmlwZSkudG9Qcm9taXNlKCk7XG4gICAgICB0aGlzLmVsZW1lbnRzLmVtaXQodGhpcy5fZWxlbWVudHMpO1xuXG4gICAgICB0aGlzLnN0YXRlID0gJ3JlYWR5JztcbiAgICB9XG4gIH1cblxuICBmZXRjaFVwZGF0ZXMoKSB7XG4gICAgaWYgKCF0aGlzLl9lbGVtZW50cykgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIGZyb20odGhpcy5fZWxlbWVudHMuZmV0Y2hVcGRhdGVzKCkpO1xuICB9XG5cbiAgdXBkYXRlKG9wdGlvbnM6IFN0cmlwZUVsZW1lbnRzVXBkYXRlT3B0aW9ucykge1xuICAgIGlmICghdGhpcy5fZWxlbWVudHMpIHJldHVybiBudWxsO1xuICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy51cGRhdGUob3B0aW9ucyk7XG4gIH1cblxuICBzdWJtaXQoKSB7XG4gICAgaWYgKCF0aGlzLl9lbGVtZW50cykgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIGZyb20odGhpcy5fZWxlbWVudHMuc3VibWl0KCkpO1xuICB9XG5cbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2FkZHJlc3MnKTogU3RyaXBlQWRkcmVzc0VsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAncGF5bWVudE1ldGhvZE1lc3NhZ2luZycpOiBTdHJpcGVQYXltZW50TWV0aG9kTWVzc2FnaW5nRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdhZmZpcm1NZXNzYWdlJyk6IFN0cmlwZUFmZmlybU1lc3NhZ2VFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2FmdGVycGF5Q2xlYXJwYXlNZXNzYWdlJyk6IFN0cmlwZUFmdGVycGF5Q2xlYXJwYXlNZXNzYWdlRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdhdUJhbmtBY2NvdW50Jyk6IFN0cmlwZUF1QmFua0FjY291bnRFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2NhcmQnKTogU3RyaXBlQ2FyZEVsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAnY2FyZE51bWJlcicpOiBTdHJpcGVDYXJkTnVtYmVyRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdjYXJkRXhwaXJ5Jyk6IFN0cmlwZUNhcmRFeHBpcnlFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2NhcmRDdmMnKTogU3RyaXBlQ2FyZEN2Y0VsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAnZnB4QmFuaycpOiBTdHJpcGVGcHhCYW5rRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdlcHNCYW5rJyk6IFN0cmlwZUVwc0JhbmtFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ3AyNEJhbmsnKTogU3RyaXBlUDI0QmFua0VsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAnaWJhbicpOiBTdHJpcGVJYmFuRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdpZGVhbEJhbmsnKTogU3RyaXBlSWRlYWxCYW5rRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdsaW5rQXV0aGVudGljYXRpb24nKTogU3RyaXBlTGlua0F1dGhlbnRpY2F0aW9uRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdleHByZXNzQ2hlY2tvdXQnKTogU3RyaXBlRXhwcmVzc0NoZWNrb3V0RWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdwYXltZW50Jyk6IFN0cmlwZVBheW1lbnRFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ3BheW1lbnRSZXF1ZXN0QnV0dG9uJyk6IFN0cmlwZVBheW1lbnRSZXF1ZXN0QnV0dG9uRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdzaGlwcGluZ0FkZHJlc3MnKTogU3RyaXBlU2hpcHBpbmdBZGRyZXNzRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGUpIHtcbiAgICBpZiAoIXRoaXMuX2VsZW1lbnRzKSByZXR1cm4gbnVsbDtcblxuICAgIHN3aXRjaCAoZWxlbWVudFR5cGUpIHtcbiAgICAgIGNhc2UgJ2FkZHJlc3MnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnYWRkcmVzcycpO1xuICAgICAgY2FzZSAncGF5bWVudE1ldGhvZE1lc3NhZ2luZyc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdwYXltZW50TWV0aG9kTWVzc2FnaW5nJyk7XG4gICAgICBjYXNlICdhZmZpcm1NZXNzYWdlJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ2FmZmlybU1lc3NhZ2UnKTtcbiAgICAgIGNhc2UgJ2FmdGVycGF5Q2xlYXJwYXlNZXNzYWdlJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ2FmdGVycGF5Q2xlYXJwYXlNZXNzYWdlJyk7XG4gICAgICBjYXNlICdhdUJhbmtBY2NvdW50JzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ2F1QmFua0FjY291bnQnKTtcbiAgICAgIGNhc2UgJ2NhcmQnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnY2FyZCcpO1xuICAgICAgY2FzZSAnY2FyZE51bWJlcic6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdjYXJkTnVtYmVyJyk7XG4gICAgICBjYXNlICdjYXJkRXhwaXJ5JzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ2NhcmRFeHBpcnknKTtcbiAgICAgIGNhc2UgJ2NhcmRDdmMnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnY2FyZEN2YycpO1xuICAgICAgY2FzZSAnZnB4QmFuayc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdmcHhCYW5rJyk7XG4gICAgICBjYXNlICdlcHNCYW5rJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ2Vwc0JhbmsnKTtcbiAgICAgIGNhc2UgJ3AyNEJhbmsnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgncDI0QmFuaycpO1xuICAgICAgY2FzZSAnaWJhbic6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdpYmFuJyk7XG4gICAgICBjYXNlICdpZGVhbEJhbmsnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnaWRlYWxCYW5rJyk7XG4gICAgICBjYXNlICdsaW5rQXV0aGVudGljYXRpb24nOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnbGlua0F1dGhlbnRpY2F0aW9uJyk7XG4gICAgICBjYXNlICdleHByZXNzQ2hlY2tvdXQnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnZXhwcmVzc0NoZWNrb3V0Jyk7XG4gICAgICBjYXNlICdwYXltZW50JzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ3BheW1lbnQnKTtcbiAgICAgIGNhc2UgJ3BheW1lbnRSZXF1ZXN0QnV0dG9uJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ3BheW1lbnRSZXF1ZXN0QnV0dG9uJyk7XG4gICAgICBjYXNlICdzaGlwcGluZ0FkZHJlc3MnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnc2hpcHBpbmdBZGRyZXNzJyk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudChlbGVtZW50VHlwZSk7XG4gICAgfVxuICB9XG59XG4iXX0=